# 从零搭建迷你登录系统 — 手把手教程

> 目标：亲手从空文件夹开始，搭一个「只有登录 + 登录后显示一段文字」的小系统，把前后端串起来。  
> 技术：**Node.js + Express**（后端）、**一个 HTML 页面**（前端），无需 Vue/React、无需数据库。  
> 建议：**尽量自己敲代码**，不要整段复制，敲一遍印象更深。

---

## 前置要求

- 本机已安装 **Node.js**（建议 16+）。终端执行 `node -v` 有版本号即可。
- 一个代码编辑器（如 Cursor / VS Code）。

---

## 第一步：建项目目录并初始化

1. 在任意位置新建一个文件夹，例如：`mini-login-demo`。
2. 用终端进入该目录：
   ```bash
   cd 你的路径/mini-login-demo
   ```
3. 初始化 npm（会生成 `package.json`）：
   ```bash
   npm init -y
   ```
4. 安装唯一依赖 Express：
   ```bash
   npm install express
   ```

---

## 第二步：写后端 — `server.js`

在项目根目录（和 `package.json` 同级）**新建文件** `server.js`，把下面代码**亲手敲进去**（或对照着敲，注意大小写和符号）。

```javascript
const express = require('express');
const path = require('path');

const app = express();
const PORT = 3000;

// 解析 JSON 请求体（登录时前端会发 JSON）
app.use(express.json());

// 静态文件：把 public 目录下的文件直接提供给浏览器
app.use(express.static(path.join(__dirname, 'public')));

// 模拟用户表（实际项目会查数据库）
const users = [
  { username: 'admin', password: '123456' },
  { username: 'test',  password: '123456' }
];

// 登录接口：POST /api/login
app.post('/api/login', (req, res) => {
  const { username, password } = req.body || {};
  const user = users.find(u => u.username === username && u.password === password);
  if (!user) {
    return res.status(401).json({ success: false, message: '用户名或密码错误' });
  }
  res.json({ success: true, message: '登录成功', username: user.username });
});

// 首页：返回登录页（即 public/index.html）
app.get('/', (req, res) => {
  res.sendFile(path.join(__dirname, 'public', 'index.html'));
});

app.listen(PORT, () => {
  console.log('迷你登录系统已启动: http://localhost:' + PORT);
});
```

**这段代码在做什么？**

- 用 Express 起一个 HTTP 服务，端口 3000。
- `express.json()`：能解析前端发来的 JSON  body。
- `express.static('public')`：浏览器访问根路径时，会去 `public` 里找文件（例如 `index.html`）。
- `POST /api/login`：接收 `username`、`password`，在内存里比对；成功返回 `{ success: true, ... }`，失败返回 401 和错误信息。
- `GET /`：把 `public/index.html` 发给浏览器，所以打开 http://localhost:3000 就是登录页。

---

## 第三步：建前端目录和页面

1. 在项目根目录下**新建文件夹** `public`。
2. 在 `public` 里**新建文件** `index.html`。
3. 把下面整段 HTML（含样式和脚本）**敲进** `index.html`。可以分块敲：先 `<!DOCTYPE>` 到 `</head>`，再 `<body>` 里的结构，最后 `<script>`。

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>迷你登录系统</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: sans-serif; max-width: 400px; margin: 60px auto; padding: 20px; }
    h1 { font-size: 1.25rem; margin-bottom: 20px; }
    input { width: 100%; padding: 10px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px; }
    button { width: 100%; padding: 10px; background: #1989fa; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #0d7de0; }
    .welcome { display: none; padding: 20px; background: #f5f5f5; border-radius: 8px; margin-top: 20px; }
    .welcome.show { display: block; }
    .error { color: #e74c3c; font-size: 14px; margin-top: 8px; }
  </style>
</head>
<body>
  <div id="loginBox">
    <h1>登录</h1>
    <form id="loginForm">
      <input type="text" id="username" placeholder="用户名" value="admin" required />
      <input type="password" id="password" placeholder="密码" value="123456" required />
      <button type="submit">登录</button>
    </form>
    <p id="errorMsg" class="error"></p>
  </div>

  <div id="welcomeBox" class="welcome">
    <h1>欢迎</h1>
    <p>你已成功登录。这是登录后看到的唯一一段文本。</p>
    <p><button type="button" id="logoutBtn">退出</button></p>
  </div>

  <script>
    const loginBox = document.getElementById('loginBox');
    const welcomeBox = document.getElementById('welcomeBox');
    const loginForm = document.getElementById('loginForm');
    const errorMsg = document.getElementById('errorMsg');
    const logoutBtn = document.getElementById('logoutBtn');

    // 页面加载时：若本地存了登录态则直接显示欢迎页
    if (localStorage.getItem('loggedIn') === 'yes') {
      loginBox.style.display = 'none';
      welcomeBox.classList.add('show');
    }

    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorMsg.textContent = '';
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;

      try {
        const res = await fetch('/api/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });
        const data = await res.json();

        if (data.success) {
          localStorage.setItem('loggedIn', 'yes');
          localStorage.setItem('username', data.username || username);
          loginBox.style.display = 'none';
          welcomeBox.classList.add('show');
        } else {
          errorMsg.textContent = data.message || '登录失败';
        }
      } catch (err) {
        errorMsg.textContent = '网络错误，请检查后端是否启动';
      }
    });

    logoutBtn.addEventListener('click', () => {
      localStorage.removeItem('loggedIn');
      localStorage.removeItem('username');
      welcomeBox.classList.remove('show');
      loginBox.style.display = 'block';
    });
  </script>
</body>
</html>
```

**这段前端在做什么？**

- **登录框**：用户名、密码、提交按钮；提交时用 `fetch` 发 `POST /api/login`，body 是 `{ username, password }`。
- **欢迎块**：默认隐藏；登录成功后显示「你已成功登录。这是登录后看到的唯一一段文本。」和「退出」按钮。
- **登录态**：用 `localStorage` 存 `loggedIn`，下次打开页面若已登录则直接显示欢迎块。
- **退出**：清掉 `localStorage`，再显示登录框。

---

## 第四步：运行并自测

1. 在项目根目录执行：
   ```bash
   node server.js
   ```
   终端应出现：`迷你登录系统已启动: http://localhost:3000`

2. 浏览器打开：**http://localhost:3000**
   - 应看到登录页，用户名已填 `admin`，密码已填 `123456`。
3. 点击「登录」：
   - 应跳成欢迎页，显示「你已成功登录。这是登录后看到的唯一一段文本。」
4. 点击「退出」：
   - 应回到登录页。
5. 再试错误密码（如把密码改成 `111111` 再登录）：
   - 应看到「用户名或密码错误」之类的提示。

若以上都通过，说明你的**前端页面 → 后端接口 → 再回到前端**这一整条链路已经跑通。

---

## 第五步：理解「前后端各做了什么」（方便汇报）

可以自己用几句话总结（或写进笔记）：

| 角色 | 做了什么 |
|------|----------|
| **前端（index.html）** | 展示登录表单和欢迎文字；用户点登录时用 `fetch` 把用户名、密码发给后端；根据返回的 `success` 显示欢迎页或错误信息；用 `localStorage` 记住是否已登录。 |
| **后端（server.js）** | 提供 `POST /api/login`：收到用户名、密码后在自己内存里的 `users` 里比对；成功就返回 `{ success: true, username }`，失败就返回 401 和错误信息；同时提供静态文件，把 `public/index.html` 给浏览器。 |

**请求流程一句话**：浏览器打开页面 → 用户输入并点登录 → 前端 `fetch('/api/login', { body: { username, password } })` → 后端校验并返回 JSON → 前端根据结果切换显示登录框或欢迎段文字。

---

## 目录结构小结（你应得到的样子）

```
mini-login-demo/
├── package.json      # npm init -y 生成，并加了 express 依赖
├── server.js         # 后端：Express + /api/login + 静态文件
├── public/
│   └── index.html    # 前端：登录表单 + 欢迎文字 + 简单 JS
└── node_modules/     # npm install 后出现，不用改
```

---

## 可选：和现有周报项目对比

- 周报项目：**Vue 前端** + **Spring Boot 后端**，前端通过 axios 调接口，后端用 Controller + Service + Mapper。
- 本迷你项目：**一个 HTML 页** + **Node/Express**，前端用 `fetch`，后端就是一个 `app.post('/api/login', ...)`。

逻辑是一样的：**前端发请求 → 后端处理并返回数据 → 前端根据数据改界面**。把这一步走通，再去看周报项目会更容易理解。

---

*按上面步骤从头敲一遍，大约 30～60 分钟即可完成。遇到报错先看终端和浏览器控制台（F12）的错误信息，再对照代码检查拼写和路径。*
